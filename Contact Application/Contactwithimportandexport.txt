package ContactApp;

import java.io.*;
import java.security.PublicKey;
import java.util.*;

import org.w3c.dom.UserDataHandler;

import Collections.*;

class ContactAddress{
	String city = null,country = null,address = null,postalCode = null ;
	public ContactAddress(String city,String country,String address,String postalCode) {
		this.address = address;
		this.city = city;
		this.country = country;
		this.postalCode = postalCode;
	}
}
public class Contact implements ContactMethods {
    private String firstName,lastName,dateOfBirth,group, primaryMobileNo,email,web;
    StringBuffer Notes;
    private Hashmap<String,String> AdditionalMobileNo = new Hashmap<String,String>();
    private Hashmap<String,String> SocialNetworks = new Hashmap<String, String>();
    public Hashmap<String,String> additionalFields  = new Hashmap<String, String>();
    ContactAddress addressDetails;
    public void addNewContact(String firstName,String lastName,String dateOfBirth,String group,
                              StringBuffer Notes,String primaryMobileNo, Hashmap<String,String> AdditionalMobileNo,Hashmap<String,String> SocialNetworks,String city,String country,String address,String email,String web,String PostalCode,Hashmap<String, String> additionalFields ) {
        this.firstName = firstName;
        this.lastName = lastName;
        this.dateOfBirth = dateOfBirth;
        this.group = group;
        if(Notes != null) {
        	this.Notes = Notes;
        }
        this.primaryMobileNo = primaryMobileNo;
        this.AdditionalMobileNo = AdditionalMobileNo;
        if(SocialNetworks != null) {
        	this.SocialNetworks = SocialNetworks;
        }
        addressDetails = new ContactAddress(city,country,address,PostalCode);
        this.email = email;
        this.web = web;
        this.additionalFields = additionalFields;
    }
    public void updateFullNameAndLastname(Contact contact,String firstName, String lastname,String dob, String group,String address,String city,String country,String postalCode,String email,String web) {
    	if(firstName != null) {
    		contact.firstName = firstName;
    	}
    	if(lastname != null) {
    		contact.lastName = lastname;
    	}
    	if(dob != null) {
    		contact.dateOfBirth = dob;
    	}
    	if(group != null) {
    		contact.group = group;
    	}
    	if(address != null) {
    		contact.addressDetails.address = address;
    	}
    	if(city != null) {
    		contact.addressDetails.city = city;
    	}
    	if(country != null) {
    		contact.addressDetails.country = country;
    	}
    	if(postalCode != null) {
    		contact.addressDetails.postalCode = postalCode;
    	}
    	if(email != null) {
    		contact.email = email;
    	}
    	if(web != null) {
    		contact.web = web;
    	}
    }
    public static void searchContact(Hashmap<String, Contact> contactList,String searchvalue) {
    	int flag = 0;
    	for(Object value : contactList.getValue()) {
    		Contact contact = (Contact) value;
    		if(contact.firstName.startsWith(searchvalue)) {
    			contact.viewContact(contact);
    			flag += 1;
    		}
    		else if(contact.primaryMobileNo.startsWith(searchvalue)) {
    			contact.viewContact(contact);
    			flag += 1;
    		}
    		else {
    			
    			for(Object mobileNumber : contact.AdditionalMobileNo.getValue() ) {
    				String MobileNumber = String.valueOf(mobileNumber);
    				if(MobileNumber.startsWith(searchvalue)) {
    					flag += 1;
    					contact.viewContact(contact);
    				}
    			}    			
    		}
    	}
    	System.out.println("Search Result is " + flag);
    }
    public void updateSocialNetwork(Contact contact,String domain, String domainLink ) {
    	contact.SocialNetworks.put(domain, domainLink);
    }
    public void updateadditionalFields(Contact contact,String FieldName, String FieldValue ) {
    	contact.additionalFields.put(FieldName, FieldValue);
    }
    public void updateAdditionalMobileNumber(Contact contact,String Number,String NumberFiled ) {
    	contact.AdditionalMobileNo.put(Number,NumberFiled);
    }
    public void updateNotes(Contact contact,String notes ) {
    	contact.Notes.append(notes);
    }
    public String removeExistingContact(Contact contact) {
    	return contact.primaryMobileNo;
    }
    public void viewContact(Contact contact){ 
    	System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
    	if(contact.firstName != null) {
    		System.out.println("Full Name : " + contact.firstName + " " + contact.lastName);
    	}
    	if(contact.primaryMobileNo != null) {
    		System.out.println("Primary Mobile Number : " + contact.primaryMobileNo);
    	}
    	if(contact.AdditionalMobileNo != null) {
    		if(contact.AdditionalMobileNo.Mapsize() != 0 ) {
	    		System.out.println( contact.AdditionalMobileNo);
	    	}
    	}
	    if(contact.dateOfBirth != null) {
    		System.out.println("Date Of Birth : " + contact.dateOfBirth);
    	}
    	if(contact.group != null) {
    		System.out.println("Group : " + contact.group);
    	}
    	if(contact.SocialNetworks != null) {
	    	if(contact.SocialNetworks.Mapsize() != 0 ) {
	    		System.out.println(contact.SocialNetworks);
	    	}
    	}
    	if(contact.Notes != null) {
    		System.out.println("Additional Notes : " + contact.Notes);
    	}
    	if(contact.addressDetails.address != null ) {
    		System.out.println("Address : " + contact.addressDetails.address);
    	}
    	if(contact.addressDetails.city != null) {
    		System.out.println("City : " + contact.addressDetails.city);
    	}
    	if(contact.addressDetails.country != null) {
    		System.out.println("Country : " + contact.addressDetails.country);
    	}
    	if(contact.email != null) {
    		System.out.println("Email : " + contact.email);
    	}
    	if(contact.web != null) {
    		System.out.println("Web : " + contact.web);
    	}
    	if(contact.additionalFields != null) {
    		System.out.println(contact.additionalFields);
    	}
    }
    public static boolean checkFieldAvailable(String field_name, Hashmap<String,String> dynamicHash){
    	if(dynamicHash != null){
			Object[] additional = dynamicHash.getKey();
			for(Object key :  additional) {
				String keyString = (String) key;
				if(keyString.equals(field_name) ){
					return true;
				}
			}
		}

    	return false;
    }
    public boolean ifExists(Contact contact,String MobileNumber){
    	for(Object value : contact.AdditionalMobileNo.getValue()) {
			String valueString = (String) value;
			if(valueString != null) {
				if(valueString .equals(MobileNumber)) {
					return true;
				}
			}
		}
    		
        return false;        
    }
    public static void ExportContacts(Hashmap<String, Contact> ContactList,String headderField) {
    	String Headder = "FullName DateOfBirth PrimaryNumber Group Notes Address City Country PostalCode " + headderField;
    	String[] additionalHeadderArray = headderField.split(" ");
		try {
			File Contactfile = new File("C:\\Users\\deeve\\OneDrive\\Desktop\\File Handling\\ContactBook.csv");
				FileWriter ContactBook = new FileWriter(Contactfile);
				ContactBook.append(Headder.toUpperCase());
				for(Object contactObject : ContactList.getValue()) {
		    		Contact contact= (Contact) contactObject;
		    		String additionalNumber = "",sociaMedia = "",additionalField = "";
		    		if(contactObject != null) {
		    			ContactBook.append("\n");
		    			ContactBook.append(contact.firstName + contact.lastName + " ");
		    			if(contact.dateOfBirth != null) {
		    				ContactBook.append(contact.dateOfBirth + " ");
		    			}
		    			else {
		    				ContactBook.append(" ");
		    			}
		    			ContactBook.append(contact.primaryMobileNo + " ");
		    			if(contact.group != null) {
		    				ContactBook.append(contact.group + " ");
		    			}
		    			else {
		    				ContactBook.append(" ");
		    			}
		    			if(contact.Notes != null) {
		    				ContactBook.append(contact.Notes + " ");
		    			}
		    			else {
		    				ContactBook.append(" ");
		    			}
		    			if(contact.addressDetails.address != null) {
		    				ContactBook.append(contact.addressDetails.address.replace(" ","") + " ");
		    			}
		    			else {
		    				ContactBook.append(" ");
		    			}
		    			if(contact.addressDetails.city != null) {
		    				ContactBook.append(contact.addressDetails.city.replace(" ","") + " ");
		    			}
		    			else {
		    				ContactBook.append(" ");
		    			}
		    			if(contact.addressDetails.country != null) {
		    				ContactBook.append(contact.addressDetails.country.replace(" ","") + " ");
		    			}
		    			else {
		    				ContactBook.append(" ");
		    			}
		    			if(contact.addressDetails.postalCode != null) {
		    				ContactBook.append(contact.addressDetails.postalCode.replace(" ","") + " ");
		    			}
		    			else {
		    				ContactBook.append(" ");
		    			}
		    			for(String fields :additionalHeadderArray){
		    				if(checkFieldAvailable(fields, contact.AdditionalMobileNo)) {
		    					ContactBook.append(contact.AdditionalMobileNo.get(fields).replace(" ","") + " ");
		    				}
		    				else if(checkFieldAvailable(fields, contact.SocialNetworks)) {
		    					ContactBook.append(contact.SocialNetworks.get(fields).replace(" ","") + " ");
		    				}    				
		    				else if(checkFieldAvailable(fields, contact.additionalFields)) {
		    					ContactBook.append(contact.additionalFields.get(fields).replace(" ","") + " ");
		    				}
		    				else {
		    					ContactBook.append(" ");
		    				}		    				
		    			}
		    		}
				}
				ContactBook.flush();
				ContactBook.close();
		   
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}catch(Exception e) {
			e.printStackTrace();
		}
	}
	
}
class ContactApplication {
    public static String ifExist(Hashmap<String, Contact> ContactList,String MobileNumber,String status) {
    	for(Object contactObject : ContactList.getValue()) {
    		Contact contact= (Contact) contactObject;
    		if(contactObject != null) {
	    		if(contact.ifExists(contact, MobileNumber)) {
	    			if(status == "search") {
	    				return "yes";
	    			}
	    			else if(status == "remove") {
	    				return contact.removeExistingContact(contact);
	    			}
	    		}
    		}
    	}
        return "no";
    }
    public static boolean checkFieldContains(String[] headder,String field) {
    	for (String ColunmField : headder) {
    		if( ColunmField.equals(field)) {
    			return(true);
    		}
    	}
    	return(false);
    }
//    public static boolean validateMobileNumber(Long MobileNumber) {
//    	String Mobilenumber = String.valueOf(MobileNumber);
//    	if(Mobilenumber.length() > 10 || Mobilenumber.length() < 10) {
//    		return false;
//    	}
//    	else {
//    		if(Mobilenumber.charAt(0) != '6' && Mobilenumber.charAt(0) != '7' && Mobilenumber.charAt(0) != '8' && Mobilenumber.charAt(0) != '9' ) {
//    			return false;
//    		}
//    	}
//		return true;    
//    while(true) {
//    	
//   		if(validateMobileNumber(additionalMobileNumber)) {
//   			break;
//   		}
//   		else {
//   			System.out.println("Invalid Mobile Number, Please Enter Valid Mobile Number");
//   		}
//   	}
//    }
//    
    public static String inputFunction(Scanner userInput,String[] Headder) {
    	String filedData = "";
    	while(true) {
			System.out.println("Enter the field name");
			filedData = userInput.nextLine();
			if(checkFieldContains(Headder,filedData)) {
				break;
			}
			else {
				System.out.println("Enter the Valid Field Name");
			}
		}
    	return filedData;
    }
    public static void main(String[] args) {
        Scanner userInput = new Scanner(System.in);
        Hashmap<String, Contact> Contactlist = new Hashmap<String,Contact>(); 
        int choice = 0;
        String primaryMobileNo = null;
        String firstName = null,lastName = null,dateOfBirth = null,group = null,address = null,city = null,country = null,email = null,web = null,postalCode = null;
        StringBuffer notes = null ;
        Hashmap<String,String> AdditionalMobileNo = null;
        Hashmap<String, String> additionalfield = new Hashmap<String, String>();
        Hashmap<String,String> SocialNetworks = null;
        Hashmap<String,String> additionalFields = null;
        Contact createContact;
        System.out.println("Hi, There you can add ,delete and update your contact here!!");
        while(true){
            System.out.println("~~~~~~~~~~~~~~~~~~~\n1.Create Contact. \n2.Display the contact list. \n3.Remove The Contact from List.\n4.Update The Contact.\n5.Search Contact from List\n6.Export The contacts\n7.Import The Contacts\n8.Exit...\n~~~~~~~~~~~~~~~~~~~");
            try {
                choice = userInput.nextInt();
            } catch (InputMismatchException e) {
                System.out.println("Invalid Input.");
                userInput.nextLine();
            }
            if(choice == 1) {
            	try {
	            	userInput.nextLine();
	                System.out.println("Enter the Person First Name and Last Name:");
	                firstName = userInput.nextLine();
	                lastName = userInput.nextLine();
	                System.out.println("Enter the Person Date Of Birth(DD-MM-YY) : ");
	                dateOfBirth = userInput.nextLine();
	                System.out.println("Enter the Person Primary Mobile Number");
	                primaryMobileNo = userInput.nextLine();
	               	if(Contactlist.ifExist(primaryMobileNo) || ifExist(Contactlist, primaryMobileNo,"search").equals("yes")  )
	               	{
	               		System.err.println("Mobile Number Already Exists You can Update by clicking 4");
	               	}
	               	else {
	               		AdditionalMobileNo = new  Hashmap<String,String>();
	               		int homecount = 1,officecount= 1,landlinecount = 1;
		                while (choice == 1) {
		                    System.out.println("If You Need to add Alternative mobile number just press 1 else press 0");
		                    choice = userInput.nextInt();
		                    userInput.nextLine();
		                    String additionalMobileNumber;
		                    if (choice == 1) {
		                    	System.out.println("Enter the Number Type Like Home/Office/Landline");
		                    	String mobileNumberField = userInput.nextLine().toUpperCase();
		                    	
		                        System.out.println("Enter the Person Mobile Number :");
		                        additionalMobileNumber = userInput.nextLine();
		                    	if(Contactlist.ifExist(additionalMobileNumber) || ifExist(Contactlist, additionalMobileNumber,"search").equals("yes") || AdditionalMobileNo.ifExist(additionalMobileNumber) || additionalMobileNumber.equals(primaryMobileNo) )
		    	               	{
		    	               		System.err.println("Mobile Number Already Exists You can Update by clicking 4");
		    	               	}
		                    	else {
		                    		if(mobileNumberField.equalsIgnoreCase("HOME")) {
			                    		mobileNumberField += String.valueOf(homecount);
			                    		homecount++;
			                    	}
		                    		if(mobileNumberField.equalsIgnoreCase("OFFICE")) {
		                    			mobileNumberField += String.valueOf(officecount);
			                    		officecount++;
		                    		}
	                    			if(mobileNumberField.equalsIgnoreCase("LANDLINE")) {
	                    				mobileNumberField += String.valueOf(landlinecount);
			                    		landlinecount++;
	                    			}
			                        AdditionalMobileNo.put( mobileNumberField,additionalMobileNumber);
			                        additionalfield.put(mobileNumberField, mobileNumberField);
		                    	}
		                    } else {
		                        choice = 0;
		                    }
		                }
		                System.out.println("If You Need to add Social Medias links just press 1 else press 0");
		                choice = userInput.nextInt();
		                if (choice == 1) {
		                	SocialNetworks = new Hashmap<String, String>();
		                    while (choice == 1) {
		                        if (choice == 1) {
		                            String domain, domainLink;
		                            userInput.nextLine();
		                            System.out.println("Enter the Person Social Media Domain :");
		                            domain = userInput.nextLine();
		                            System.out.println("Enter the Person Social Media Domain Link :");
		                            domainLink = userInput.nextLine();
		                            SocialNetworks.put(domain, domainLink);
		                            additionalfield.put(domain, domainLink);
		                        } else {
		                            choice = 0;
		                        }
		                        System.out.println(" press 1 to add or press 0 to skip");
		                        choice = userInput.nextInt();
		                    }
		                }
		                System.out.println("If You Need to add Any Notes for Remainder just press 1 else press 0");
		                choice = userInput.nextInt();
		                if (choice == 1) {
		                	notes = new StringBuffer();
		                    while (choice == 1) {	
		                        if (choice == 1) {
		                            System.out.println("Enter the Notes :");
		                            userInput.nextLine();
		                            notes.append(userInput.nextLine());
		                        } else {
		                            choice = 0;
		                        }
		                        System.out.println(" press 1 to add or press 0 to skip");
		                        choice = userInput.nextInt();
		                    }
		                }
		                System.out.println("If you need to add Address press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the Address");
							address = userInput.nextLine();
						}
						System.out.println("If you need to add City press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the City");
							city = userInput.nextLine();
						}
						System.out.println("If you need to add Country press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the Country");
							country = userInput.nextLine();
						}
						System.out.println("If you need to add PostalCode press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the Postal Code");
							postalCode = userInput.nextLine();
						}
						System.out.println("If you need to add email press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the email");
							email = userInput.nextLine();
						}
						System.out.println("If you need to add web press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the web link");
							web = userInput.nextLine();
						}
						System.out.println("If You Need to add Additional Fields just press 1 else press 0");
		                choice = userInput.nextInt();
		                if (choice == 1) {
		                	additionalFields = new Hashmap<String, String>();
		                    while (choice == 1) {
		                        if (choice == 1) {
		                            String FieldName, FieldValue;
		                            userInput.nextLine();
		                            System.out.println("Enter the Field Name :");
		                            FieldName = userInput.nextLine();
		                           
		                            System.out.println("Enter the Field Value :");
		                            FieldValue = userInput.nextLine();
		                            additionalFields.put(FieldName, FieldValue);
		                            additionalfield.put(FieldName, FieldValue);
		                        } else {
		                            choice = 0;
		                        }
		                        System.out.println(" press 1 to add or press 0 to skip");
		                        choice = userInput.nextInt();
		                    }
		                }						
		                System.out.println("Enter Group like Colleague/Friend/Family");
		                group = userInput.next();
		                createContact = new Contact();
		                createContact.addNewContact(firstName, lastName, dateOfBirth, group, notes, primaryMobileNo, AdditionalMobileNo, SocialNetworks,city,country,address,email,web,postalCode,additionalFields);
		                Contactlist.put(primaryMobileNo, createContact);
		                System.out.println(Contactlist);
	               	}
	               }catch (InputMismatchException e) {
		            	System.out.println("Invalid Input");	
		            	userInput.nextLine();
				   }catch (Exception e) {
							System.out.println("Exception Occured " + e);	
			            	userInput.nextLine();
						}
            }
            else if( choice == 2){
            	
            	Object[] MobileNumberKey = Contactlist.getKey();
            	System.out.println("Contact List ...");
                for (Object Number : MobileNumberKey){
                    if(Number != null){
                    	System.out.println(Contactlist.get((String) Number));
                    	Contactlist.get((String) Number).viewContact(Contactlist.get((String) Number));
                    }
                }
            }
            else if(choice == 3) {
            	System.out.println("Please Enter the Person Full Name or Moblile Number");
            	try {
            		userInput.nextLine();
            		String searchpreffix = userInput.nextLine();
	            	Contact.searchContact(Contactlist,searchpreffix );
	            	System.out.println("Please Enter the Person Primary Mobile Number");
            		primaryMobileNo = userInput.nextLine();
	            	if(Contactlist.ifExist(primaryMobileNo)) {
	            		Contactlist.remove(primaryMobileNo);
	            	}
	            	else {
	            		primaryMobileNo = ifExist(Contactlist, primaryMobileNo,"remove");
	            		Contactlist.remove(primaryMobileNo);
	            	}
            	}catch (InputMismatchException e) {
	            	System.out.println("Invalid Input");	
	            	userInput.nextLine();
				}catch (Exception e) {
						System.out.println("Exception Occured " + e);	
		            	userInput.nextLine();
					}
            }
            else if(choice == 4) {
            	System.out.println("Please Enter the Person Full Name or Moblile Number");
            	try {
            		userInput.nextLine();
            		String searchpreffix = userInput.nextLine();
	            	Contact.searchContact(Contactlist,searchpreffix );
	            	System.out.println("Please Enter the Person Primary Mobile Number");
            		primaryMobileNo = userInput.nextLine();
	            	Contact contact;
	            	if(Contactlist.ifExist(primaryMobileNo) || ifExist(Contactlist, primaryMobileNo,"search").equals(1L)) {
	            		if(Contactlist.ifExist(primaryMobileNo)) {
	            			contact = Contactlist.get(primaryMobileNo);
	            		}
	            		else {
	            			primaryMobileNo = ifExist(Contactlist, primaryMobileNo,"remove");
	            			contact = Contactlist.get(primaryMobileNo);
	            		}
	            		contact.viewContact(contact);
	            		System.out.println();
	            		System.out.println("If You Need To update FirstName and Lastname press 1 or press 0 to skip");
	            		choice = userInput.nextInt();
	        			firstName = null;
	        			lastName = null;
	        			dateOfBirth = null;
	        			group = null;
	        			email = null;
	        			address = null;
	        			city = null;
	        			web = null ;
	        			country = null;
	        			postalCode = null;
	            		if(choice == 1) {
	            			userInput.nextLine();		
	            			System.out.println("Enter the Person First Name and Last Name:");
	                        firstName = userInput.nextLine();
	                        lastName = userInput.nextLine();
	            		}
	                    System.out.println("If You Need To update Person Date Of Birth press 1 or press 0 to skip");
	                    choice = userInput.nextInt();
	                    if(choice == 1) {
	                        System.out.println("Enter the Person Date Of Birth(DD-MM-YY) : ");
	                        dateOfBirth = userInput.next();
	                    }
	                    System.out.println("If You Need To update Group press 1 or press 0 to skip");
	                    choice = userInput.nextInt();
	                    if(choice == 1) {
	                        System.out.println("Enter Group like Colleague/Friend/Family");
	    	                group = userInput.next();
	                    }	                    
	            		System.out.println("If You Need To add Social Network press 1 or press 0 to skip");
	            		choice = userInput.nextInt();
	                    while (choice == 1) {
	                        if (choice == 1) {
	                            String domain, domainLink;
	                            userInput.nextLine();
	                            System.out.println("Enter the Person Social Media Domain :");
	                            domain = userInput.nextLine();
	                            System.out.println("Enter the Person Social Media Domain Link :");
	                            domainLink = userInput.nextLine();
	                            contact.updateSocialNetwork(contact,domain, domainLink);
	                            additionalfield.put(domain, domainLink);
	                        } else {
	                            choice = 0;
	                        }
	                        System.out.println(" press 1 to add or press 0 to skip");
	                        choice = userInput.nextInt();
	                    }
	                    System.out.println("If You Need To add Additional Mobile Number press 1 or press 0 to skip");
	            		choice = userInput.nextInt();
	                    while (choice == 1) {
	                        if (choice == 1) {
	                        	userInput.nextLine();
	                        	System.out.println("Enter the Number Type Like Home/Office/Landline");
		                    	String mobileNumberField = userInput.nextLine().toUpperCase();
		                    	int homecount = 1,officecount= 1,landlinecount = 1;
		                    
		                        System.out.println("Enter the Person Mobile Number :");
		                        String additionalMobileNumber = userInput.nextLine();
		                    	if(Contactlist.ifExist(additionalMobileNumber) || ifExist(Contactlist, additionalMobileNumber,"search").equals("yes") || AdditionalMobileNo.ifExist(additionalMobileNumber) || additionalMobileNumber.equals(primaryMobileNo) )
		    	               	{
		    	               		System.err.println("Mobile Number Already Exists You can Update by clicking 4");
		    	               	}
		                    	else {
		                    		if(mobileNumberField.equalsIgnoreCase("HOME")) {
			                    		mobileNumberField += String.valueOf(homecount);
			                    		homecount++;
			                    	}
		                    		if(mobileNumberField.equalsIgnoreCase("OFFICE")) {
		                    			mobileNumberField += String.valueOf(officecount);
			                    		officecount++;
		                    		}
	                    			if(mobileNumberField.equalsIgnoreCase("LANDLINE")) {
	                    				mobileNumberField += String.valueOf(landlinecount);
			                    		landlinecount++;
	                    			}
			                        contact.updateAdditionalMobileNumber(contact, additionalMobileNumber, mobileNumberField);
			                        additionalfield.put(mobileNumberField, mobileNumberField);
		                    	}
	                        } else {
	                            choice = 0;
	                        }
	                        System.out.println(" press 1 to add or press 0 to skip");
	                        choice = userInput.nextInt();
	                    }
	                    System.out.println("If You Need to add Any Notes for Remainder just press 1 else press 0");
		                choice = userInput.nextInt();
		                if (choice == 1) {
		                	notes = new StringBuffer();
		                    while (choice == 1) {	
		                        if (choice == 1) {
		                            System.out.println("Enter the Notes :");
		                            userInput.nextLine();
		                            contact.updateNotes(contact, userInput.nextLine());
		                        } else {
		                            choice = 0;
		                        }
		                        System.out.println(" press 1 to add or press 0 to skip");
		                        choice = userInput.nextInt();
		                    }
		                }
		                System.out.println("If you need to update Address press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the Address");
							address = userInput.nextLine();
						}
						System.out.println("If you need to update City press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the City");
							city = userInput.nextLine();
						}
						System.out.println("If you need to update Country press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the Country");
							country = userInput.nextLine();
						}
						System.out.println("If you need to update PostalCode press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the Postal Code");
							postalCode = userInput.nextLine();
						}
						System.out.println("If you need to update email press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the email");
							email = userInput.nextLine();
						}
						System.out.println("If you need to update web press 1 for skip press 0");
						choice = userInput.nextInt();
						if(choice == 1) {
							userInput.nextLine();
							System.out.println("Enter the web link");
							web = userInput.nextLine();
						}
						System.out.println("If You Need to update Additional Fields just press 1 else press 0");
		                choice = userInput.nextInt();
		                if (choice == 1) {
		                	additionalFields = new Hashmap<String, String>();
		                    while (choice == 1) {
		                        if (choice == 1) {
		                            String FieldName, FieldValue;
		                            userInput.nextLine();
		                            System.out.println("Enter the Field Name :");
		                            FieldName = userInput.nextLine();
		                            System.out.println("Enter the Field Value :");
		                            FieldValue = userInput.nextLine();
		                            contact.updateadditionalFields(contact, FieldName, FieldValue);
		                            additionalfield.put(FieldName, FieldValue);
		                        } else {
		                            choice = 0;
		                        }
		                        
		                        System.out.println(" press 1 to add or press 0 to skip");
		                        choice = userInput.nextInt();
		                    }
		                }						
		                contact.updateFullNameAndLastname(contact, firstName,lastName, dateOfBirth, group,address,city,country,postalCode,email,web);
	                    contact.viewContact(contact);
	            	}
	            else {
	                	System.out.println("The Mobile Number You Entred is not available in your Contact list You can add it by creating the contact...");
	                }
	            	}catch (InputMismatchException e) {
	            	System.out.println("Invalid Input");	
	            	userInput.nextLine();
					}catch (Exception e) {
						System.out.println("Exception Occured " + e);	
		            	userInput.nextLine();
					}
            }
            else if(choice == 5) {
            	System.out.println("Please Enter the Person Full Name or Moblile Number");
            	try {
            		userInput.nextLine();
            		String searchpreffix = userInput.nextLine();
	            	Contact contact;
	            	Contact.searchContact(Contactlist,searchpreffix );
	            	}catch (InputMismatchException e) {
	            	System.out.println("Invalid Input");	
	            	userInput.nextLine();
					}catch (Exception e) {
						System.out.println("Exception Occured " + e);	
		            	userInput.nextLine();
					}
	            	
            	
            }
            else if(choice == 6) {
            	String headders = "";
            	for(Object addfield : additionalfield.getKey()) {
            		String field = (String) addfield;
            		if(field != null) {
            			headders += field + " ";
            		}
            	}
            	Contact.ExportContacts(Contactlist,headders);
            }
            else if(choice == 7) {
            	File ContactFile = new File("C:\\Users\\deeve\\OneDrive\\Desktop\\File Handling\\format.csv");
            	int count = 0;
            	String ContactHeadder = "FirstName LastName DateOfBirth PrimaryNumber AdditionalNumber Group Notes SocialMedia Address City Country PostalCode Email Web";
            	String Headder[] = null;
            	Hashmap<String, String> Mapfield = new Hashmap<String,String>();
            	try {
            		if(ContactFile.canRead()) {
            			Scanner fileContent = new Scanner(ContactFile);
            			while(fileContent.hasNextLine()) {
            				String[] Filedata = fileContent.nextLine().split(",");
            				int index = 0;
            				String filedData = null;
    	        			firstName = null;
    	        			lastName = null;
    	        			dateOfBirth = null;
    	        			group = null;
    	        			email = null;
    	        			address = null;
    	        			city = null;
    	        			web = null ;
    	        			country = null;
    	        			postalCode = null;
    	        			notes = null ;
    	        	        AdditionalMobileNo = null;
    	        	        SocialNetworks = null;
    	        	        additionalFields = null;
            				if(count == 0 ) {
            					Headder = Filedata;
		    					System.out.println("Fields in your files are...");
		    					for (String ColunmElement : Filedata) {
		    						System.out.print(ColunmElement + " ");
		    					}
		    					System.out.println("\n~~~~~~~~~~~~~~~~~~~~~~");
		    					System.out.println("Fileds Available in Contact Book are...");
		    					System.out.println(ContactHeadder);
		    					System.out.println("Map The Fields with Contact Book....");
	    						userInput.nextLine();
	    						while(true) {
	    							System.out.println("Primary Number is Mandatory Map with Contact Book Field");
	    							filedData = userInput.nextLine();
	    							if(checkFieldContains(Headder,filedData)) {
	    								break;
	    							}
	    							else {
	    								System.out.println("Enter the Valid Field Name");
	    							}
	    						}  						
	    						Mapfield.put(filedData, "PrimaryMobileNumber");
	    						while(true) {
	    							System.out.println("Map First Name Field with Contact Book");
	    							filedData = userInput.nextLine();
	    							if(checkFieldContains(Headder,filedData)) {
	    								break;
	    							}
	    							else {
	    								System.out.println("Enter the Valid Field Name");
	    							}
	    						} 
	    						Mapfield.put(filedData, "firstName");
	    						while(true) {
	    							System.out.println("Map Last Name Field with Contact Book");
	    							filedData = userInput.nextLine();
	    							if(checkFieldContains(Headder,filedData)) {
	    								break;
	    							}
	    							else {
	    								System.out.println("Enter the Valid Field Name");
	    							}
	    						} 
	    						Mapfield.put(filedData, "lastName");
	    						System.out.println("If you need to map with Date Of Birth Field press 1 for skip press 0");
	    						choice = userInput.nextInt();
	    						if(choice == 1) {
	    							userInput.nextLine();
	    							filedData = inputFunction(userInput, Headder); 
	    							Mapfield.put(filedData, "DOB");
	    						}
	    						System.out.println("If you need to map with Group Field press 1 for skip press 0");
	    						choice = userInput.nextInt();
	    						if(choice == 1) {
	    							userInput.nextLine();
	    							filedData = inputFunction(userInput, Headder); 
	    							Mapfield.put(filedData, "group");
	    						}
	    						System.out.println("If you need to map with Notes Field press 1 for skip press 0");
	    						choice = userInput.nextInt();
	    						if(choice == 1) {
	    							userInput.nextLine();
	    							filedData = inputFunction(userInput, Headder); 
	    							Mapfield.put(filedData, "Notes");
	    						}
	    						System.out.println("If you need to map with Address Field press 1 for skip press 0");
	    						choice = userInput.nextInt();
	    						if(choice == 1) {
	    							userInput.nextLine();
	    							filedData = inputFunction(userInput, Headder); 
	    							Mapfield.put(filedData, "Address");
	    						}
	    						System.out.println("If you need to map with City Field press 1 for skip press 0");
	    						choice = userInput.nextInt();
	    						if(choice == 1) {
	    							userInput.nextLine();
	    							filedData = inputFunction(userInput, Headder); 
	    							Mapfield.put(filedData, "City");
	    						}
	    						System.out.println("If you need to map with Country Field press 1 for skip press 0");
	    						choice = userInput.nextInt();
	    						if(choice == 1) {
	    							userInput.nextLine();
	    							filedData = inputFunction(userInput, Headder); 
	    							Mapfield.put(filedData, "Country");
	    						}
	    						System.out.println("If you need to map with PostalCode Field press 1 for skip press 0");
	    						choice = userInput.nextInt();
	    						if(choice == 1) {
	    							userInput.nextLine();
	    							filedData = inputFunction(userInput, Headder); 
	    							Mapfield.put(filedData, "PostalCode");
	    						}
	    						System.out.println("If you need to map with email Field press 1 for skip press 0");
	    						choice = userInput.nextInt();
	    						if(choice == 1) {
	    							userInput.nextLine();
	    							filedData = inputFunction(userInput, Headder); 
	    							Mapfield.put(filedData, "email");
	    						}
	    						System.out.println("If you need to map with web Field press 1 for skip press 0");
	    						choice = userInput.nextInt();
	    						if(choice == 1) {
	    							userInput.nextLine();
	    							filedData = inputFunction(userInput, Headder); 
	    							Mapfield.put(filedData, "web");
	    						}
	    						while(true) {
	    							System.out.println("If You Need to map additional Mobile numbers press 1 or press 0");
	    							choice = userInput.nextInt();
	    							if(choice == 1) {
	    								userInput.nextLine();
	    								filedData = inputFunction(userInput, Headder); 
	    								Mapfield.put(filedData, "AdditionalNumber");
	    							}
	    							else {
	    								break;
	    							}	    							
	    						}
	    						while(true) {
	    							System.out.println("If You Need to map Additional Fields press 1 or press 0");
	    							choice = userInput.nextInt();
	    							if(choice == 1) {
	    								userInput.nextLine();
	    								filedData = inputFunction(userInput, Headder); 
	    								Mapfield.put(filedData, "Additional");
	    							}
	    							else {
	    								break;
	    							}	    							
	    						}
	    						System.err.println(Mapfield);
            				}
            				if(count > 0) {
	            				for(String Colunmelement : Filedata) {            					
	            					if(Mapfield.get(Headder[index]) != null) {
		            					switch(Mapfield.get(Headder[index])) {
		            					case "firstName":
		            						firstName = Colunmelement;
		            						break;
		            					case "lastName":
		            						lastName = Colunmelement;
		            						break;
		            					case "PrimaryMobileNumber":
		            						primaryMobileNo = Colunmelement;
		            						break;
		            					case "Country":
		            						country = Colunmelement;
		            						break;
		            					case "PostalCode":
		            						postalCode  = Colunmelement;
		            						break;
		            					case "City":
		            						city = Colunmelement;
		            						break;
		            					case "Address" : 
		            						address = Colunmelement;
		            						break;
		            					case "email":
		            						email = Colunmelement;
		            						break;
		            					case "web":
		            						web = Colunmelement;
		            						break;
		            					case "Additional":
		            						additionalFields = new Hashmap<String, String>();
		            						additionalFields.put(Headder[index], Colunmelement);
		            						additionalfield.put(Headder[index], Colunmelement);
		            						break;
		            					case "AdditionalNumber" : 
		            						AdditionalMobileNo = new Hashmap<String, String>();
		            						AdditionalMobileNo.put(Headder[index], Colunmelement);
		            						additionalfield.put(Headder[index], Colunmelement);
		            						break;
		            					}
	            					}
	            					index++;
	            				}
	            				createContact = new Contact();
	            				createContact.addNewContact(firstName, lastName, dateOfBirth, group, notes, primaryMobileNo, AdditionalMobileNo, SocialNetworks,city,country,address,email,web,postalCode,additionalFields);
	     		                Contactlist.put(primaryMobileNo, createContact);
            				}
            				count++;            				
            			}
            			fileContent.close();
            		}
            		System.out.println(Contactlist.Mapsize());
            		System.out.println(count);
            	}
            	catch (Exception e) {
            		System.out.println("Exception occured" + e);
				}
            }
            else if(choice == 8) {
            	System.out.println("Bye...");
            	break;
            }
            	
        }
    }
}
